# BMH05102
一个关于BMH05102模块的使用
由于在网上没有找到关于这个模块的使用，于是查看datasheet完成了这个模块的人体成分测量使用


**注意**: 此设备仅用于健康参考，不能替代专业医疗建议。如有健康问题，请咨询专业医生。

## 简介

此项目使用 ESP32-S3 微控制器通过串口通信控制 BMH05102 人体成分分析传感器，实现：
- 人体生物电阻抗（BIA）测量
- 多种身体成分数据计算
- 双手/双脚测量模式切换
- 实时数据显示和健康评估

## 硬件连接

### 引脚连接表 //实际修改为自己开发板的引脚
| BMH05102 | ESP32-S3 | 说明 |
|----------|----------|------|
| VCC      | 3.3V     | 电源正极 |
| GND      | GND      | 电源负极 |
| TX       | GPIO4    | 串口发送 |
| RX       | GPIO5    | 串口接收 |
| ENABLE   | GPIO2    | 模块使能控制 |

### 硬件要求
- ESP32-S3 开发板（如 ESP32-S3-DevKitC-1）
- BMH05102 人体成分分析传感器模块
- 导线若干
- 电极片或手柄（用于人体接触）

## 快速开始

### 环境准备
1. 安装 [PlatformIO IDE](https://platformio.org/platformio-ide) 或使用 PlatformIO 扩展
2. 克隆或下载此项目到本地

### 编译和上传
```bash
# 编译项目
pio run

# 上传到开发板
pio run --target upload

# 打开串口监视器
pio device monitor
```

### 用户信息配置
在 `src/main.cpp` 文件中修改用户信息：
```cpp
UserInfo user = {
  .age = 21,          // 年龄
  .gender = 1,        // 性别 (0=女性, 1=男性)
  .height = 175.0,    // 身高 (cm)
  .weight = 64.0,     // 体重 (kg)
  .activity = 3       // 活动等级 (1-5)
};
```

## 功能特性

### 测量数据
- **体脂率** - 身体脂肪占体重的百分比
- **肌肉量** - 身体肌肉的重量
- **骨量** - 骨骼矿物质的重量
- **水分含量** - 身体水分占体重的百分比
- **内脏脂肪** - 内脏周围脂肪的等级
- **基础代谢率** - 每日基础代谢消耗的卡路里
- **体年龄** - 根据身体成分计算的生理年龄
- **蛋白质率** - 身体蛋白质含量百分比
- **皮下脂肪量** - 皮下脂肪的重量
- **BMI指数** - 身体质量指数

### 健康评估
- 各项指标的等级评估（不足/标准/优秀等）
- 基于性别和年龄的个性化标准
- 实时健康建议和风险提示

### 测量模式
- **双脚模式** - 传统体脂秤测量方式
- **双手模式** - 手持电极测量方式
- 模式可通过代码切换

## 🔍 工作原理

### 生物电阻抗分析（BIA）
1. 通过电极向人体发送微弱的交流电
2. 测量电流通过人体时的阻抗值
3. 基于阻抗值和个人信息计算身体成分

### 通信协议
- 使用串口通信（9600 波特率）
- 自定义协议帧格式
- 支持命令发送和数据接收
- 包含校验位确保数据完整性


## 使用说明

### 测量准备
1. 确保硬件连接正确
2. 上传代码到 ESP32-S3
3. 打开串口监视器（115200 波特率）
4. 修改用户信息以获得准确结果

### 测量过程
1. 设备初始化并显示连接状态
2. 根据提示选择测量模式
3. 按照指示进行人体接触
4. 等待测量完成并查看结果

### 注意事项
- 测量时保持身体稳定，避免移动
- 确保电极与皮肤良好接触

## 🛠️ 开发配置

### platformio.ini 配置
```ini
[env:esp32-s3-devkitc-1]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino
monitor_speed = 115200
```

### 开发环境
- **平台**: ESP32 (Espressif32)
- **框架**: Arduino
- **开发板**: ESP32-S3-DevKitC-1
- **监视器波特率**: 115200

## 输出示例

```
=== BMH05102 人体成分分析仪 ===
硬件连接:
BMH05102 TX -> ESP32-S3 GPIO4
BMH05102 RX -> ESP32-S3 GPIO5
BMH05102 VCC -> 3.3V
BMH05102 GND -> GND
BMH05102 ENABLE -> ESP32-S3 GPIO2

👤 用户信息: 男性, 21岁, 175.0cm, 64.0kg

✅ 阻抗测量成功
✅ 原始阻抗: 520 Ω

🧬 人体成分分析结果:
================================
💧 水分含量: 62.3%
🥩 体脂率: 12.5% (理想)
💪 肌肉量: 52.1 kg
🦴 骨量: 2.8 kg
🫀 内脏脂肪: 3级 (正常)
🔥 基础代谢: 1680 kcal/天
🎂 体年龄: 19 岁
💊 蛋白质率: 18.2%
🧈 皮下脂肪: 6.3 kg
⚖️ BMI指数: 20.9
================================
```

## 故障排除

### 常见问题
1. **无法连接模块**
   - 检查硬件连接
   - 确认电源供电正常
   - 验证引脚配置

2. **阻抗测量失败**
   - 检查人体与电极接触
   - 确保皮肤清洁干燥
   - 避免金属饰品干扰

3. **数据异常**
   - 核对用户信息设置
   - 检查测量环境
   - 重新校准设备
